import{M as r,D as c}from"../chunks/types-BDZaX-gQ.js";console.log("[LLM翻译] Service Worker 已启动");chrome.runtime.onMessage.addListener((e,o,n)=>{var t,a;switch(console.log("[LLM翻译] 收到消息:",e.type,e.payload),e.type){case r.GET_CONFIG:return s().then(n),!0;case r.SAVE_CONFIG:return i(e.payload).then(n),!0;case r.START_TRANSLATION:u((t=o.tab)==null?void 0:t.id),n({success:!0});break;case r.RESTORE_PAGE:l((a=o.tab)==null?void 0:a.id),n({success:!0});break;default:console.warn("[LLM翻译] 未知消息类型:",e.type)}return!1});async function s(){const e=await chrome.storage.sync.get("config");return{...c,...e.config}}async function i(e){const n={...await s(),...e};return await chrome.storage.sync.set({config:n}),{success:!0}}async function u(e){if(!e){console.error("[LLM翻译] 无法获取标签页 ID");return}chrome.tabs.sendMessage(e,{type:r.START_TRANSLATION,payload:{}})}async function l(e){if(!e){console.error("[LLM翻译] 无法获取标签页 ID");return}chrome.tabs.sendMessage(e,{type:r.RESTORE_PAGE,payload:{}})}chrome.runtime.onInstalled.addListener(e=>{console.log("[LLM翻译] 扩展已安装/更新:",e.reason),e.reason==="install"&&chrome.storage.sync.set({config:c})});
